---
title: Image Compressor
---

<style>
    body {
        font-family: Arial, sans-serif;
        margin: 2em;
    }
    .results {
        margin-top: 2em;
    }
    .image-row {
        margin-bottom: 1em;
    }
    .stats {
        font-size: 0.95em;
        color: #444;
    }
    .download-btn {
        margin-left: 1em;
    }
</style>
<section class="text-slate-700">
    <div class="w-full flex flex-row-reverse md:flex-row gap-4 md:gap-24">
        <div
            class="basis-[40%] flex-0 min-h-[25vh] p-8 bg-zinc-200 cursor-pointer rounded-md border-2 border-dashed border-zinc-700 text-center flex flex-col flex-wrap gap-4 align-center justify-center"
            id="drop-zone"
        >
            <input
                type="file"
                id="file-input"
                multiple
                accept="image/*"
                style="display: none"
            />
            <h2 class="decoration-0!">
                Drag &amp; drop<br />
                or click to select
            </h2>
            <p class="text-sm text-slate-700">
                Upload PNG, JPEG, WEBP or HEIF images
            </p>
        </div>
        <div class="flex-1">
            <h1 class="mb-4 md:mb-8">Image Compressor</h1>
            <p class="text-xl">
                Instantly compress images for free, browser-side image
                compression tool.
            </p>
            <ul class="list-disc text-lg">
                <li>Privacy Friendly, client side compression</li>
                <li>Ad Free</li>
                <li>No Usage Limits</li>
            </ul>
        </div>
    </div>
    <div>
        <ul id="file-list" class="mt-8 *:m-0!"></ul>
        <button
            id="compress-btn"
            class="mt-4 px-4 py-2 bg-blue-500 text-slate-100 text-lg rounded-md"
        >
            Compress All
        </button>
        <button
            id="download-all-btn"
            class="mt-4 px-4 py-2 bg-blue-500 text-slate-100 text-lg rounded-md hidden"
        >
            Download All
        </button>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script>
        // Image Compressor JS with Drag & Drop
        const elemDropZone = document.getElementById("drop-zone");
        const elemFileInput = document.getElementById("file-input");
        const elemCompressBtn = document.getElementById("compress-btn");
        const elemDownloadAllBtn = document.getElementById("download-all-btn");
        const elemFileList = document.getElementById("file-list");

        let files = [];

        // Drag & Drop handlers
        elemDropZone.addEventListener("click", () => elemFileInput.click());

        elemDropZone.addEventListener("dragover", (e) => {
            e.preventDefault();
            elemDropZone.classList.add("dragover");
        });

        elemDropZone.addEventListener("dragleave", (e) => {
            e.preventDefault();
            elemDropZone.classList.remove("dragover");
        });

        elemDropZone.addEventListener("drop", (e) => {
            e.preventDefault();
            elemDropZone.classList.remove("dragover");
            handleFiles(e.dataTransfer.files);
        });

        elemFileInput.addEventListener("change", (e) => {
            handleFiles(e.target.files);
        });

        function handleFiles(fileList) {
            const newFiles = Array.from(fileList)
                .filter((f) => f.type.startsWith("image/"))
                .map((f) => {
                    // Generate preview
                    return {
                        file: f,
                        previewUrl: URL.createObjectURL(f),
                    };
                });

            files = files.concat(newFiles);
            renderFileList();
        }

        elemCompressBtn.addEventListener("click", async () => {
            if (!files.length) {
                alert("Please select image(s) first.");
                return;
            }
            for (let i = 0; i < files.length; ++i) {
                if (!files[i].compressedBlob) {
                    await compressAndStore(i);
                }
            }
            renderFileList();
        });

        async function compressAndStore(idx) {
            const f = files[idx];
            const { compressedBlob, originalSize, percent, format } =
                await compressImage(f.file);
            files[idx] = {
                ...f,
                compressedBlob,
                percent,
                format,
            };
        }

        async function compressImage(file) {
            const originalSize = file.size;
            const img = await loadImage(file);
            const format = getImageFormat(file);
            const mime = "image/" + format;
            const quality = format === "jpeg" ? 0.7 : 0.8; // adjust as needed

            // Draw to canvas
            const canvas = document.createElement("canvas");
            canvas.width = img.naturalWidth;
            canvas.height = img.naturalHeight;
            const ctx = canvas.getContext("2d");
            ctx.drawImage(img, 0, 0);

            // Compress
            const blob = await new Promise((resolve) =>
                canvas.toBlob(resolve, mime, quality),
            );
            const compressedSize = blob.size;
            const percent = (
                (100 * (originalSize - compressedSize)) / originalSize || 0
            ).toFixed(1);

            return {
                compressedBlob: blob,
                originalSize,
                percent,
                format,
            };
        }

        function loadImage(file) {
            return new Promise((resolve, reject) => {
                const img = new window.Image();
                img.onload = () => resolve(img);
                img.onerror = reject;
                img.src = URL.createObjectURL(file);
            });
        }

        function getImageFormat(file) {
            const ext = file.name.split(".").pop().toLowerCase();
            if (ext === "jpg" || ext === "jpeg") return "jpeg";
            if (ext === "webp") return "webp";
            return "png";
        }

        async function downloadZip(results) {
            const zip = new JSZip();
            results.forEach((res) => {
                const fname =
                    res.file.name.replace(/\.[^.]+$/, "") +
                    "-compressed." +
                    res.format;
                zip.file(fname, res.compressedBlob);
            });
            const blob = await zip.generateAsync({ type: "blob" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = "compressed-images.zip";
            document.body.appendChild(a);
            a.click();
            setTimeout(() => {
                URL.revokeObjectURL(url);
                a.remove();
            }, 100);
        }

        function renderFileList() {
            elemFileList.innerHTML = "";
            files.forEach((f, i) => {
                let html = `
                    <li class="p-4 flex flex-row justify-start items-center gap-4 border border-zinc-200">
                        <img src="${f.previewUrl}" width="50" height="50" class="w-[50px] h-[50px] rounded-[4px] border border-gray-500 object-cover" alt="preview" />
                        <div class="block flex-0 basis-[80%]">
                            <p class="font-bold">${f.file.name}</p>
                            <p class="text-sm">
                                ${(f.file.size / (1024 * 1024)).toFixed(2)}MB
                                ${
                                    f.compressedBlob
                                        ? ` &ShortRightArrow; ${(f.compressedBlob.size / (1024 * 1024)).toFixed(2)}MB (${f.percent}%)`
                                        : ""
                                }
                            </p>
                        </div>
                        ${
                            f.compressedBlob
                                ? `<button data-idx="${i}" class="download-btn px-2 py-1 border border-blue-400 rounded-sm text-xs font-bold text-blue-400 uppercase hover:text-white hover:bg-blue-400">Download</button>`
                                : `<button data-idx="${i}" class="compress-btn px-2 py-1 border border-green-400 rounded-sm text-xs font-bold text-green-600 uppercase hover:text-white hover:bg-green-400">Compress</button>`
                        }
                    </li>
                `;
                elemFileList.innerHTML += html;
            });
            // Attach download handlers
            document.querySelectorAll(".download-btn").forEach((btn) => {
                btn.onclick = () => {
                    const idx = btn.getAttribute("data-idx");
                    const f = files[idx];
                    const url = URL.createObjectURL(f.compressedBlob);
                    const a = document.createElement("a");
                    a.href = url;
                    a.download =
                        f.file.name.replace(/\.[^.]+$/, "") +
                        "-compressed." +
                        f.format;
                    document.body.appendChild(a);
                    a.click();
                    setTimeout(() => {
                        URL.revokeObjectURL(url);
                        a.remove();
                    }, 100);
                };
            });

            // Attach per-file compress handlers
            document.querySelectorAll(".compress-btn").forEach((btn) => {
                btn.onclick = async () => {
                    const idx = btn.getAttribute("data-idx");
                    await compressAndStore(idx);
                    renderFileList();
                };
            });

            // Show/hide Download All
            const anyCompressed = files.some((f) => f.compressedBlob);
            if (anyCompressed) {
                elemDownloadAllBtn.classList.remove("hidden");
            } else {
                elemDownloadAllBtn.classList.add("hidden");
            }
        }
    </script>
</section>
